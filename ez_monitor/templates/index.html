<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Metrics Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .metric-container {
            width: calc(50% - 10px);
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            box-sizing: border-box;
        }
        .progress-bar {
            width: 100%;
            height: 30px;
            background-color: #333;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress {
            height: 100%;
            width: 0;
            transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }
        .label {
            margin-bottom: 10px;
            font-size: 18px;
            font-weight: bold;
        }
        .info {
            font-size: 14px;
            margin-top: 10px;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 5px;
        }
        .value-box {
            display: inline-block;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            margin-right: 10px;
            margin-bottom: 5px;
        }
        .dynamic-info {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="metric-container">
            <div class="label">CPU Usage</div>
            <div class="progress-bar">
                <div id="cpuProgress" class="progress"></div>
            </div>
            <div id="cpuPercent" class="value-box"></div>
            <div id="cpuUsage" class="value-box"></div>
            <div id="cpuInfo" class="info"></div>
            <div id="cpuDynamicInfo" class="dynamic-info"></div>
        </div>
        <div class="metric-container">
            <div class="label">Memory Usage</div>
            <div class="progress-bar">
                <div id="memoryProgress" class="progress"></div>
            </div>
            <div id="memoryPercent" class="value-box"></div>
            <div id="memoryUsage" class="value-box"></div>
            <div id="memoryInfo" class="info"></div>
        </div>
    </div>

    <script>
        function updateMetrics() {
            fetch('/metrics')
                .then(response => response.json())
                .then(data => {
                    updateCPUMetric(data.cpu);
                    updateMemoryMetric(data.memory);
                })
                .catch(error => console.error('Error fetching metrics:', error));
        }

        function updateCPUMetric(cpu) {
            const progress = document.getElementById('cpuProgress');
            const percentElement = document.getElementById('cpuPercent');
            const usageElement = document.getElementById('cpuUsage');
            const infoElement = document.getElementById('cpuInfo');
            const dynamicInfoElement = document.getElementById('cpuDynamicInfo');
            
            progress.style.width = `${cpu.usage}%`;
            percentElement.textContent = `${cpu.usage.toFixed(1)}%`;
            usageElement.textContent = `${cpu.count} cores`;
            infoElement.innerHTML = `
                Name: ${cpu.name}<br>
                Frequency: ${cpu.frequency}
            `;
            dynamicInfoElement.innerHTML = `
                <div class="value-box">Tasks: ${cpu.tasks}</div>
                <div class="value-box">Threads: ${cpu.threads}</div>
                <div class="value-box">Running: ${cpu.running}</div>
                <div class="value-box">Load Avg: ${cpu.load_average}</div>
            `;
            
            updateProgressColor(progress, cpu.usage);
        }

        function updateMemoryMetric(memory) {
            const progress = document.getElementById('memoryProgress');
            const percentElement = document.getElementById('memoryPercent');
            const usageElement = document.getElementById('memoryUsage');
            const infoElement = document.getElementById('memoryInfo');
            
            progress.style.width = `${memory.percent}%`;
            percentElement.textContent = `${memory.percent.toFixed(1)}%`;
            usageElement.textContent = `${memory.used} / ${memory.total}`;
            infoElement.innerHTML = `
                Total RAM: ${memory.total}<br>
                Swap Total: ${memory.swap_total}
            `;
            
            updateProgressColor(progress, memory.percent);
        }

        function updateProgressColor(progressElement, value) {
            const hue = (1 - value / 100) * 120;
            progressElement.style.backgroundColor = `hsl(${hue}, 100%, 50%)`;
        }

        // Update metrics every second
        setInterval(updateMetrics, 1000);
    </script>
</body>
</html>
